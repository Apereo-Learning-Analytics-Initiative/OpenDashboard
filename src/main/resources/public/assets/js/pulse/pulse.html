<section class="col-md-12">
    <div class="col-md-12">

        <div class="od-breadcrumb">
            <!-- 
            When viewing outside of a LMS the breadcrumb is to include navigation for
            viewing the listing of all classes.

            When viewing from within a LMS the breadcrumb is to only provide navitation
            withing the selected class.
            -->
            <a class="back-link" href="" ui-sref="index.courselist({groupId: null})" ng-show="!isLtiSession" ng-if="listType !== 'classes'">
                <i class="fa fa-chevron-left"></i> 
                Class List
            </a>

            <a class="back-link" href="" ui-sref="index.courselist({groupId: currentCourse.id})" ng-show="!isLtiSession" ng-if="listType === 'student'">
                <i class="fa fa-chevron-left"></i> 
                {{currentCourse.label}}
            </a>

            <span class="title-dropdown" ng-if="listType == 'classes'"><a href="">
                Select Course
            </a></span>

            <span class="title-dropdown" ng-if="listType == 'students' || listType == 'student'"> 
                
                <span class="filters"  ng-if="listType !== 'classes'"">
                    <a href="#" uib-popover-template="'filters.html'" popover-placement="bottom" popover-title="Filters"><i class="fa fa-cog fa-lg"></i></a>
                    <script type="text/ng-template" id="filters.html">
                        <span class="filter-item">
                            <input id="" type="checkbox">
                            Hasn't logged in for <input type="number" value="0" min="0"> days</span>
                        <span class="filter-item">
                            <input id="" type="checkbox">
                            <input type="number" value="0" min="0"> number of submission late or missing</span>
                        <span class="filter-item">
                            <input id="" type="checkbox">
                            Current Course Grade/Score below <input type="number" value="0" min="0"></span>
                        <span class="filter-item">
                            <input id="" type="checkbox">
                            Current Course Grade/Score below <input type="number" value="0" min="0"></span>
                        <span class="filter-item" ng-show="listType == 'students' || listType == 'student'">
                            <input id="assignment-toggle" type="checkbox" ng-model="$parent.$parent.$parent.assignmentOverlay"> Assignment Overlay
                        </span>
                    </script>
                
                </span>

                <span class="dropdown" ng-show="!isLtiSession">
                  <a href="" data-toggle="dropdown">{{currentCourse.label}}
                  <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                    <li ng-repeat="course in classes">
                        <a href="#" ng-click="$emit('chart-change', {id: course.id, type: 'course', notify: true})">{{course.label}}</a>
                    </li>
                  </ul>
                </span>

                <a href="" ng-show="isLtiSession" ng-click="$emit('chart-change', {id: currentCourse.id, type: 'course', notify: true})">{{currentCourse.label}}</a>
            </span>
        </div>
        
        <div id="pulse-wrapper">
            
            <div class="zoom-actions">
                <i class="fa fa-search-minus zoom-out"></i>
            </div>

            <table id="pulse-table" class="table table-striped table-condensed table-pulse">
                <thead>
                    <tr>
                        <th class="actions" ng-if="listType == 'students'">
                            <a href="" class="fa fa-envelope"></a>
                        </th>
                        <th ng-if="listType == 'classes'" ng-click="$parent.orderByField='label'; $parent.reverseSort = !$parent.reverseSort">
                            Class Name 
                            <i ng-if="$parent.orderByField=='label' && !$parent.reverseSort" class="fa fa-caret-down"></i>
                            <i ng-if="$parent.orderByField=='label' && $parent.reverseSort" class="fa fa-caret-up"></i>
                        </th>
                        <th ng-if="listType != 'classes'" ng-click="$parent.orderByField='firstName'; $parent.reverseSort = !$parent.reverseSort">
                            First Name
                            <i ng-if="$parent.orderByField=='firstName' && !$parent.reverseSort" class="fa fa-caret-down"></i>
                            <i ng-if="$parent.orderByField=='firstName' && $parent.reverseSort" class="fa fa-caret-up"></i>
                        </th>
                        <th ng-if="listType != 'classes'" ng-click="$parent.orderByField='lastName'; $parent.reverseSort = !$parent.reverseSort">
                            Last Name
                            <i ng-if="$parent.orderByField=='lastName' && !$parent.reverseSort" class="fa fa-caret-down"></i>
                            <i ng-if="$parent.orderByField=='lastName' && $parent.reverseSort" class="fa fa-caret-up"></i>
                        </th>
                        <th ng-if="listType != 'classes'" ng-click="$parent.orderByField='risk'; $parent.reverseSort = !$parent.reverseSort">
                            Risk
                            <i ng-if="$parent.orderByField=='risk' && !$parent.reverseSort" class="fa fa-caret-down"></i>
                            <i ng-if="$parent.orderByField=='risk' && $parent.reverseSort" class="fa fa-caret-up"></i>
                        </th>
                        <th ng-if="listType != 'classes'" ng-click="$parent.orderByField='grade'; $parent.reverseSort = !$parent.reverseSort">
                            Grade
                            <i ng-if="$parent.orderByField=='grade' && !$parent.reverseSort" class="fa fa-caret-down"></i>
                            <i ng-if="$parent.orderByField=='grade' && $parent.reverseSort" class="fa fa-caret-up"></i>
                        </th>
                        <th ng-if="listType != 'classes'" ng-click="$parent.orderByField='activity'; $parent.reverseSort = !$parent.reverseSort">
                            Activity
                            <i ng-if="$parent.orderByField=='activity' && !$parent.reverseSort" class="fa fa-caret-down"></i>
                            <i ng-if="$parent.orderByField=='activity' && $parent.reverseSort" class="fa fa-caret-up"></i>
                        </th>
                        <th id="timeline-heading">

                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in datalist|orderBy:orderByField:reverseSort" ng-repeat-finish="draw-chart">
                        <td ng-if="listType == 'students'">
                            <a href="" class="fa fa-envelope"></a>
                        </td>
                        <td ng-if="listType == 'classes'">
                            <a ui-sref="index.courselist({groupId: item.id})">{{item.label}}</a>
                        </td>
                        <td ng-if="listType != 'classes'">
                            <a href="" ng-click="$emit('chart-change', {id: item.id, type: 'student'})">{{item.firstName}}</a>
                        </td>
                        <td ng-if="listType != 'classes'">
                            <a href="" ng-click="$emit('chart-change', {id: item.id, type: 'student'})">{{item.lastName}}</a>
                        </td>
                        <td ng-if="listType != 'classes'">
                            {{item.risk}}
                        </td>
                        <td ng-if="listType != 'classes'">
                            {{item.grade}}
                        </td>
                        <td ng-if="listType != 'classes'">
                            {{item.activity}}
                        </td>
                        <td id="pulse-chart-{{item.id}}"></td>
                    </tr>
                </tbody>
            </table>
            <div ng-show="assignmentOverlay" id="assignment-overlay"><svg></svg></div>
        </div>


        <div class="modal fade" id="emailModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Email {{emailstudent.name}}</h4>
              </div>
              <div class="modal-body">
                <div ng-if="sent" class="alert alert-success">
                    Email sent to {{emailstudent.name}}.
                </div>
                <form action="">
                    <div class="form-group">
                        <label for="exampleInputEmail1">message</label>
                        <textarea class="form-control"></textarea>
                        
                    </div>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" ng-click="sent = 1">Send Email</button>
              </div>
            </div>
          </div>
        </div>
    </div>
</section>
<div class="ui-view" ng-if="listType == 'student'"></div>

<div class="tooltips">
    <div class="tool-tip-info tool-tip-event-info" ng-show="chartInfo">
        <i class="fa fa-info-circle"></i>
        <span>
            <span class="info-label">Date:</span>
            <span class="info-value">{{chartInfo.date | amDateFormat:'M-D'}}</span>
        </span>
        <span>
            <span class="info-label">Events:</span>
            <span class="info-value">{{chartInfo.events}}</span>
        </span>
    </div>


    <div class="tool-tip-info tool-tip-assignment-info" ng-show="assignmentInfo">
        <i class="fa fa-info-circle"></i>
        <span>
            <span class="info-label">Title:</span>
            <span class="info-value">{{assignmentInfo.label}}</span>
        </span>
        <span>
            <span class="info-label">Date:</span>
            <span class="info-value">{{assignmentInfo.date | amDateFormat:'M-D'}}</span>
        </span>
        <span>
            <span class="info-label">Type:</span>
            <span class="info-value">{{assignmentInfo.events}}</span>
        </span>
    </div>
</div>



